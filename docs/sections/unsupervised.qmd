# Unsupervised learning

* Clustering and/or dimension reduction

Trying to Cluster commune datas to:
1. Reduce dimension
2. See similarities

A regarder, est-ce qu'on fait un cluster pour les datas politques + un cluster pour les data démographiques, ou est-ce qu'on regroupe tout?

```{r}
# faudra changer les colonnes "select" si on sépare demographique et politique
cols_cluster <- select(df_commune, -REGION, -CODE_REGION)

# A reflechir, scale ou pas scale? pour l'instant je scale
cols_cluster <- scale(cols_cluster)

dist_matrix <- dist(cols_cluster, method ="euclidean")
hclust <- hclust(dist_matrix, method = "centroid")

dend <- as.dendrogram(hclust)
dend <- color_branches(dend, k = 26)  # Adjust the number of clusters as needed

y_zoom_range <- c(0, 10)
par(cex = 0.6)  # Adjust the font size for better visualization
plot(dend, main = "Hierarchical Clustering Dendrogram", horiz = FALSE,ylim = y_zoom_range)  # Set horiz to FALSE for vertical dendrogram

# Cut the dendrogram to obtain clusters
#clusters <- cutree(hclust_model, k = 5)  # Adjust the number of clusters as needed
```

## Tax
```{r}
#library(dendextend)

# Clean data and convert to numeric
cleaned_impots <- apply(impots, 2, function(x) as.numeric(gsub("[^0-9.-]", "", x)))
cleaned_impots[is.na(cleaned_impots)] <- 0  # Replace NA values with 0

# Scale the features
scaled_impots <- scale(cleaned_impots)

# Perform k-means clustering
k <- 2  # Initial guess for the number of clusters
kmeans_model <- kmeans(scaled_impots, centers = k)

# Check within-cluster sum of squares (elbow method)
wss <- numeric(10)
for (i in 1:10) {
  kmeans_model <- kmeans(scaled_impots, centers = i)
  wss[i] <- sum(kmeans_model$withinss)
}
plot(1:10, wss, type = "b", xlab = "Number of Clusters", ylab = "Within groups sum of squares")

# Adjust k based on elbow method
k <- 5  # Adjust based on the plot

# Perform k-means clustering again with optimal k
kmeans_model <- kmeans(scaled_impots, centers = k)

# Assign cluster labels to dendrogram
clusters <- kmeans_model$cluster

# Plot dendrogram
plot(colored_dend, main = "Hierarchical Clustering Dendrogram", horiz = FALSE, ylim = y_zoom_range)

```
```{r}
# Get the cluster centers
cluster_centers <- kmeans_model$centers

# Create a data frame with cluster centers
cluster_centers_df <- data.frame(cluster = 1:k, cluster_centers)

# Print cluster centers
print(cluster_centers_df)

# Calculate the size of each cluster
cluster_sizes <- table(kmeans_model$cluster)

# Print cluster sizes
print(cluster_sizes)


```

